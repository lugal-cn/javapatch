(function(){var E=CKEDITOR.htmlParser.fragment.prototype,J=CKEDITOR.htmlParser.element.prototype;E.onlyChild=J.onlyChild=function(){var c=this.children,b=c.length,a=(b==1)&&c[0];return a||null};J.removeAnyChildWithName=function(b){var c=this.children,a=[],e;for(var d=0;d<c.length;d++){e=c[d];if(!e.name){continue}if(e.name==b){a.push(e);c.splice(d--,1)}a=a.concat(e.removeAnyChildWithName(b))}return a};J.getAncestor=function(b){var a=this.parent;while(a&&!(a.name&&a.name.match(b))){a=a.parent}return a};E.firstChild=J.firstChild=function(a){var b;for(var c=0;c<this.children.length;c++){b=this.children[c];if(a(b)){return b}else{if(b.name){b=b.firstChild(a);if(b){return b}}}}return null};J.addStyle=function(d,f,a){var e,c="";if(typeof f=="string"){c+=d+":"+f+";"}else{if(typeof d=="object"){for(var b in d){if(d.hasOwnProperty(b)){c+=b+":"+d[b]+";"}}}else{c+=d}a=f}if(!this.attributes){this.attributes={}}e=this.attributes.style||"";e=(a?[c,e]:[e,c]).join(";");this.attributes.style=e.replace(/^;|;(?=;)/,"")};J.getStyle=function(b){var a=this.attributes.style;if(a){a=CKEDITOR.tools.parseCssText(a,1);return a[b]}};CKEDITOR.dtd.parentOf=function(a){var b={};for(var c in this){if(c.indexOf("$")==-1&&this[c][a]){b[c]=1}}return b};function K(d){var i=d.children,j,b,e=d.children.length,f,c,a=/list-style-type:(.*?)(?:;|$)/,g=CKEDITOR.plugins.pastefromword.filters.stylesFilter;b=d.attributes;if(a.exec(b.style)){return}for(var h=0;h<e;h++){j=i[h];if(j.attributes.value&&Number(j.attributes.value)==h+1){delete j.attributes.value}f=a.exec(j.attributes.style);if(f){if(f[1]==c||!c){c=f[1]}else{c=null;break}}}if(c){for(h=0;h<e;h++){b=i[h].attributes;b.style&&(b.style=g([["list-style-type"]])(b.style)||"")}d.addStyle("list-style-type",c)}}var y=/^([.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz){1}?/i;var v=/^(?:\b0[^\s]*\s*){1,4}$/;var F="^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$",D=new RegExp(F),N=new RegExp(F.toUpperCase());var B={decimal:/\d+/,"lower-roman":D,"upper-roman":N,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},C={disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/},u={ol:B,ul:C},I=[[1000,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],H="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function x(e){e=e.toUpperCase();var d=I.length,f=0;for(var a=0;a<d;++a){for(var b=I[a],c=b[1].length;e.substr(0,c)==b[1];e=e.substr(c)){f+=b[0]}}return f}function A(d){d=d.toUpperCase();var b=H.length,a=1;for(var c=1;d.length>0;c*=b){a+=H.indexOf(d.charAt(d.length-1))*c;d=d.substr(0,d.length-1)}return a}var z=0,G=null,L;var M=(CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(b,a){var c=new CKEDITOR.htmlParser.element("cke:listbullet");c.attributes={"cke:listsymbol":b[0]};c.add(new CKEDITOR.htmlParser.text(a));return c},isListBulletIndicator:function(b){var a=b.attributes&&b.attributes.style;if(/mso-list\s*:\s*Ignore/i.test(a)){return true}},isContainingOnlySpaces:function(b){var a;return((a=b.onlyChild())&&(/^(:?\s|&nbsp;)+$/).test(a.value))},resolveList:function(a){var c=a.attributes,b;if((b=a.removeAnyChildWithName("cke:listbullet"))&&b.length&&(b=b[0])){a.name="cke:li";if(c.style){c.style=M.filters.stylesFilter([["text-indent"],["line-height"],[(/^margin(:?-left)?$/),null,function(e){var d=e.split(" ");e=CKEDITOR.tools.convertToPx(d[3]||d[1]||d[0]);if(!z&&G!==null&&e>G){z=e-G}G=e;c["cke:indent"]=z&&(Math.ceil(e/z)+1)||1}],[(/^mso-list$/),null,function(e){e=e.split(" ");var f=Number(e[0].match(/\d+/)),d=Number(e[1].match(/\d+/));if(d==1){f!==L&&(c["cke:reset"]=1);L=f}c["cke:indent"]=d}]])(c.style,a)||""}if(!c["cke:indent"]){G=0;c["cke:indent"]=1}CKEDITOR.tools.extend(c,b.attributes);return true}else{L=G=z=null}return false},getStyleComponents:(function(){var a=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"></div>',CKEDITOR.document);CKEDITOR.document.getBody().append(a);return function(c,e,d){a.setStyle(c,e);var b={},f=d.length;for(var g=0;g<f;g++){b[d[g]]=a.getStyle(d[g])}return b}})(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(d,k){k=typeof k=="number"?k:1;var j=d.attributes,c;switch(j.type){case"a":c="lower-alpha";break;case"1":c="decimal";break}var g=d.children,h;for(var b=0;b<g.length;b++){h=g[b];if(h.name in CKEDITOR.dtd.$listItem){var e=h.attributes,i=h.children,m=i.length,l=i[m-1];if(l.name in CKEDITOR.dtd.$list){d.add(l,b+1);if(!--i.length){g.splice(b--,1)}}h.name="cke:li";j.start&&!b&&(e.value=j.start);M.filters.stylesFilter([["tab-stops",null,function(n){var o=n.split(" ")[1].match(y);o&&(G=CKEDITOR.tools.convertToPx(o[0]))}],(k==1?["mso-list",null,function(n){n=n.split(" ");var o=Number(n[0].match(/\d+/));o!==L&&(e["cke:reset"]=1);L=o}]:null)])(e.style);e["cke:indent"]=k;e["cke:listtype"]=d.name;e["cke:list-style-type"]=c}else{if(h.name in CKEDITOR.dtd.$list){arguments.callee.apply(this,[h,k+1]);g=g.slice(0,b).concat(h.children).concat(g.slice(b+1));d.children=[];for(var f=0,a=g.length;f<a;f++){d.add(g[f])}}}}delete d.name;j["cke:list"]=1},assembleList:function(o){var g=o.children,R,s,r,i,n,m,d,a=[],c,e;var b,f,l,q;for(var k=0;k<g.length;k++){R=g[k];if("cke:li"==R.name){R.name="li";s=R;r=s.attributes;b=r["cke:listsymbol"];b=b&&b.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);f=l=q=null;if(r["cke:ignored"]){g.splice(k--,1);continue}r["cke:reset"]&&(d=n=m=null);i=Number(r["cke:indent"]);if(i!=n){e=c=null}if(!b){f=r["cke:listtype"]||"ol";l=r["cke:list-style-type"]}else{if(e&&u[e][c].test(b[1])){f=e;l=c}else{for(var j in u){for(var h in u[j]){if(u[j][h].test(b[1])){if(j=="ol"&&(/alpha|roman/).test(h)){var Q=/roman/.test(h)?x(b[1]):A(b[1]);if(!q||Q<q){q=Q;f=j;l=h}}else{f=j;l=h;break}}}}}!f&&(f=b[2]?"ol":"ul")}e=f;c=l||(f=="ol"?"decimal":"disc");if(l&&l!=(f=="ol"?"decimal":"disc")){s.addStyle("list-style-type",l)}if(f=="ol"&&b){switch(l){case"decimal":q=Number(b[1]);break;case"lower-roman":case"upper-roman":q=x(b[1]);break;case"lower-alpha":case"upper-alpha":q=A(b[1]);break}s.attributes.value=q}if(!d){a.push(d=new CKEDITOR.htmlParser.element(f));d.add(s);g[k]=d}else{if(i>n){a.push(d=new CKEDITOR.htmlParser.element(f));d.add(s);m.add(d)}else{if(i<n){var p=n-i,t;while(p--&&(t=d.parent)){d=t.parent}d.add(s)}else{d.add(s)}}g.splice(k--,1)}m=s;n=i}else{if(d){d=n=m=null}}}for(k=0;k<a.length;k++){K(a[k])}d=n=m=L=G=z=null},falsyFilter:function(a){return false},stylesFilter:function(a,b){return function(e,c){var f=[];(e||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(l,m,i){m=m.toLowerCase();m=="font-family"&&(i=i.replace(/["']/g,""));var j,n,h,g;for(var k=0;k<a.length;k++){if(a[k]){j=a[k][0];n=a[k][1];h=a[k][2];g=a[k][3];if(m.match(j)&&(!n||i.match(n))){m=g||m;b&&(h=h||i);if(typeof h=="function"){h=h(i,c,m)}if(h&&h.push){m=h[0],h=h[1]}if(typeof h=="string"){f.push([m,h])}return}}}!b&&f.push([m,i])});for(var d=0;d<f.length;d++){f[d]=f[d].join(":")}return f.length?(f.join(";")+";"):false}},elementMigrateFilter:function(b,a){return b?function(d){var c=a?new CKEDITOR.style(b,a)._.definition:b;d.name=c.element;CKEDITOR.tools.extend(d.attributes,CKEDITOR.tools.clone(c.attributes));d.addStyle(CKEDITOR.style.getStyleText(c))}:function(){}},styleMigrateFilter:function(b,a){var c=this.elementMigrateFilter;return b?function(f,g){var e=new CKEDITOR.htmlParser.element(null),d={};d[a]=f;c(b,d)(e);e.children=g.children;g.children=[e];e.filter=function(){};e.parent=g}:function(){}},bogusAttrFilter:function(a,b){if(b.name.indexOf("cke:")==-1){return false}},applyStyleFilter:null},getRules:function(j,m){var e=CKEDITOR.dtd,n=CKEDITOR.tools.extend({},e.$block,e.$listItem,e.$tableContent),a=j.config,o=this.filters,b=o.falsyFilter,P=o.stylesFilter,t=o.elementMigrateFilter,l=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),p=this.utils.createListBulletMarker,f=o.flattenList,i=o.assembleList,q=this.utils.isListBulletIndicator,s=this.utils.isContainingOnlySpaces,r=this.utils.resolveList,k=function(O){O=CKEDITOR.tools.convertToPx(O);return isNaN(O)?O:O+"px"},d=this.utils.getStyleComponents,c=this.utils.listDtdParents,h=a.pasteFromWordRemoveFontStyles!==false,g=a.pasteFromWordRemoveStyles!==false;return{elementNames:[[(/meta|link|script/),""]],root:function(O){O.filterChildren(m);i(O)},elements:{"^":function(R){var O;if(CKEDITOR.env.gecko&&(O=o.applyStyleFilter)){O(R)}},$:function(O){var T=O.name||"",U=O.attributes;if(T in n&&U.style){U.style=P([[(/^(:?width|height)$/),null,k]])(U.style)||""}if(T.match(/h\d/)){O.filterChildren(m);if(r(O)){return}t(a["format_"+T])(O)}else{if(T in e.$inline){O.filterChildren(m);if(s(O)){delete O.name}}else{if(T.indexOf(":")!=-1&&T.indexOf("cke")==-1){O.filterChildren(m);if(T=="v:imagedata"){var V=O.attributes["o:href"];if(V){O.attributes.src=V}O.name="img";return}delete O.name}}}if(T in c){O.filterChildren(m);i(O)}},style:function(U){if(CKEDITOR.env.gecko){var V=U.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/),T=V&&V[1],O={};if(T){T.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(aa,Q,R){Q=Q.split(",");var ab=Q.length,Z;for(var S=0;S<ab;S++){CKEDITOR.tools.trim(Q[S]).replace(/^(\w+)(\.[\w-]+)?$/g,function(Y,X,W){X=X||"*";W=W.substring(1,W.length);if(W.match(/MsoNormal/)){return}if(!O[X]){O[X]={}}if(W){O[X][W]=R}else{O[X]=R}})}});o.applyStyleFilter=function(S){var X=O["*"]?"*":S.name,Q=S.attributes&&S.attributes["class"],R;if(X in O){R=O[X];if(typeof R=="object"){R=R[Q]}R&&S.addStyle(R,true)}}}}return false},p:function(S){if((/MsoListParagraph/i).exec(S.attributes["class"])||S.getStyle("mso-list")){var O=S.firstChild(function(Q){return Q.type==CKEDITOR.NODE_TEXT&&!s(Q.parent)});var T=O&&O.parent;if(T){T.addStyle("mso-list","Ignore")}}S.filterChildren(m);if(r(S)){return}if(a.enterMode==CKEDITOR.ENTER_BR){delete S.name;S.add(new CKEDITOR.htmlParser.element("br"))}else{t(a["format_"+(a.enterMode==CKEDITOR.ENTER_P?"p":"div")])(S)}},div:function(U){var T=U.onlyChild();if(T&&T.name=="table"){var V=U.attributes;T.attributes=CKEDITOR.tools.extend(T.attributes,V);V.style&&T.addStyle(V.style);var O=new CKEDITOR.htmlParser.element("div");O.addStyle("clear","both");U.add(O);delete U.name}},td:function(O){if(O.getAncestor("thead")){O.name="th"}},ol:f,ul:f,dl:f,font:function(U){if(q(U.parent)){delete U.name;return}U.filterChildren(m);var V=U.attributes,O=V.style,T=U.parent;if("font"==T.name){CKEDITOR.tools.extend(T.attributes,U.attributes);O&&T.addStyle(O);delete U.name}else{O=O||"";if(V.color){V.color!="#000000"&&(O+="color:"+V.color+";");delete V.color}if(V.face){O+="font-family:"+V.face+";";delete V.face}if(V.size){O+="font-size:"+(V.size>3?"large":(V.size<3?"small":"medium"))+";";delete V.size}U.name="span";U.addStyle(O)}},span:function(ae){if(q(ae.parent)){return false}ae.filterChildren(m);if(s(ae)){delete ae.name;return null}if(q(ae)){var af=ae.firstChild(function(Q){return Q.value||Q.name=="img"});var ab=af&&(af.value||"l."),Z=ab&&ab.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(Z){var ad=p(Z,ab);var ac=ae.getAncestor("span");if(ac&&(/ mso-hide:\s*all|display:\s*none /).test(ac.attributes.style)){ad.attributes["cke:ignored"]=1}return ad}}var ag=ae.children,O=ae.attributes,ah=O&&O.style,aa=ag&&ag[0];if(ah){O.style=P([["line-height"],[(/^font-family$/),null,!h?l(a.font_style,"family"):null],[(/^font-size$/),null,!h?l(a.fontSize_style,"size"):null],[(/^color$/),null,!h?l(a.colorButton_foreStyle,"color"):null],[(/^background-color$/),null,!h?l(a.colorButton_backStyle,"color"):null]])(ah,ae)||""}if(!O.style){delete O.style}if(CKEDITOR.tools.isEmpty(O)){delete ae.name}return null},b:t(a.coreStyles_bold),i:t(a.coreStyles_italic),u:t(a.coreStyles_underline),s:t(a.coreStyles_strike),sup:t(a.coreStyles_superscript),sub:t(a.coreStyles_subscript),a:function(O){var R=O.attributes;if(R&&!R.href&&R.name){delete O.name}else{if(CKEDITOR.env.webkit&&R.href&&R.href.match(/file:\/\/\/[\S]+#/i)){R.href=R.href.replace(/file:\/\/\/[^#]+/i,"")}}},"cke:listbullet":function(O){if(O.getAncestor(/h\d/)&&!a.pasteFromWordNumberedHeadingToList){delete O.name}}},attributeNames:[[(/^onmouse(:?out|over)/),""],[(/^onload$/),""],[(/(?:v|o):\w+/),""],[(/^lang/),""]],attributes:{style:P(g?[[(/^list-style-type$/),null],[(/^margin$|^margin-(?!bottom|top)/),null,function(O,T,U){if(T.name in {p:1,div:1}){var V=a.contentsLangDirection=="ltr"?"margin-left":"margin-right";if(U=="margin"){O=d(U,O,[V])[V]}else{if(U!=V){return null}}if(O&&!v.test(O)){return[V,O]}}return null}],[(/^clear$/)],[(/^border.*|margin.*|vertical-align|float$/),null,function(O,R){if(R.name=="img"){return O}}],[(/^width|height$/),null,function(O,R){if(R.name in {table:1,td:1,th:1,img:1}){return O}}]]:[[(/^mso-/)],[(/-color$/),null,function(O){if(O=="transparent"){return false}if(CKEDITOR.env.gecko){return O.replace(/-moz-use-text-color/g,"transparent")}}],[(/^margin$/),v],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],h?[(/font-?/)]:null],g),width:function(O,R){if(R.name in e.$tableContent){return false}},border:function(O,R){if(R.name in e.$tableContent){return false}},"class":b,bgcolor:b,valign:g?b:function(O,R){R.addStyle("vertical-align",O);return false}},comment:!CKEDITOR.env.ie?function(ab,ah){var aa=ab.match(/<img.*?>/),ag=ab.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);if(ag){var ae=ag[1]||(aa&&"l."),ac=ae&&ae.match(/>(?:[(]?)([^\s]+?)([.)]?)</);return p(ac,ae)}if(CKEDITOR.env.gecko&&aa){var af=CKEDITOR.htmlParser.fragment.fromHtml(aa[0]).children[0],ad=ah.previous,Z=ad&&ad.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/),O=Z&&Z[1];O&&(af.attributes.src=O);return af}return false}:b}}});var w=function(){this.dataFilter=new CKEDITOR.htmlParser.filter()};w.prototype={toHtml:function(a){var c=CKEDITOR.htmlParser.fragment.fromHtml(a),b=new CKEDITOR.htmlParser.basicWriter();c.writeHtml(b,this.dataFilter);return b.getHtml(true)}};CKEDITOR.cleanWord=function(a,c){if(CKEDITOR.env.gecko){a=a.replace(/(<!--\[if[^<]*?\])-->([\S\s]*?)<!--(\[endif\]-->)/gi,"$1$2$3")}if(CKEDITOR.env.webkit){a=a.replace(/(class="MsoListParagraph[^>]+><!--\[if !supportLists\]-->)([^<]+<span[^<]+<\/span>)(<!--\[endif\]-->)/gi,"$1<span>$2</span>$3")}var d=new w(),b=d.dataFilter;b.addRules(CKEDITOR.plugins.pastefromword.getRules(c,b));c.fire("beforeCleanWord",{filter:b});a=a.replace(/cke:.*?".*?"/g,"");a=a.replace(/style=""/g,"");a=a.replace(/<span>/g,"");return a}})();