(function(a,b){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}(this.options.addClasses&&this.element.addClass("ui-draggable"));(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));this._mouseInit()},destroy:function(){if(!this.element.data("draggable")){return}this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this},_mouseCapture:function(c){var d=this.options;if(this.helper||d.disabled||a(c.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(c);if(!this.handle){return false}if(d.iframeFix){a(d.iframeFix===true?"iframe":d.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(a(this).offset()).appendTo("body")})}return true},_mouseStart:function(c){var d=this.options;this.helper=this._createHelper(c);this._cacheHelperProportions();if(a.ui.ddmanager){a.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:c.pageX-this.offset.left,top:c.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(c);this.originalPageX=c.pageX;this.originalPageY=c.pageY;(d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt));if(d.containment){this._setContainment()}if(this._trigger("start",c)===false){this._clear();return false}this._cacheHelperProportions();if(a.ui.ddmanager&&!d.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,c)}this.helper.addClass("ui-draggable-dragging");this._mouseDrag(c,true);if(a.ui.ddmanager){a.ui.ddmanager.dragStart(this,c)}return true},_mouseDrag:function(e,d){this.position=this._generatePosition(e);this.positionAbs=this._convertPositionTo("absolute");if(!d){var c=this._uiHash();if(this._trigger("drag",e,c)===false){this._mouseUp({});return false}this.position=c.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if(a.ui.ddmanager){a.ui.ddmanager.drag(this,e)}return false},_mouseStop:function(c){var d=false;if(a.ui.ddmanager&&!this.options.dropBehaviour){d=a.ui.ddmanager.drop(this,c)}if(this.dropped){d=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original"){return false}if((this.options.revert=="invalid"&&!d)||(this.options.revert=="valid"&&d)||this.options.revert===true||(a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d))){var e=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(e._trigger("stop",c)!==false){e._clear()}})}else{if(this._trigger("stop",c)!==false){this._clear()}}return false},_mouseUp:function(c){if(this.options.iframeFix===true){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}if(a.ui.ddmanager){a.ui.ddmanager.dragStop(this,c)}return a.ui.mouse.prototype._mouseUp.call(this,c)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(c){var d=!this.options.handle||!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==c.target){d=true}});return d},_createHelper:function(c){var d=this.options;var e=a.isFunction(d.helper)?a(d.helper.apply(this.element[0],[c])):(d.helper=="clone"?this.element.clone().removeAttr("id"):this.element);if(!e.parents("body").length){e.appendTo((d.appendTo=="parent"?this.element[0].parentNode:d.appendTo))}if(e[0]!=this.element[0]&&!(/(fixed|absolute)/).test(e.css("position"))){e.css("position","absolute")}return e},_adjustOffsetFromHelper:function(c){if(typeof c=="string"){c=c.split(" ")}if(a.isArray(c)){c={left:+c[0],top:+c[1]||0}}if("left" in c){this.offset.click.left=c.left+this.margins.left}if("right" in c){this.offset.click.left=this.helperProportions.width-c.right+this.margins.left}if("top" in c){this.offset.click.top=c.top+this.margins.top}if("bottom" in c){this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){c.left+=this.scrollParent.scrollLeft();c.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)){c={top:0,left:0}}return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var c=this.element.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var c=this.options;if(c.containment=="parent"){c.containment=this.helper[0].parentNode}if(c.containment=="document"||c.containment=="window"){this.containment=[c.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,c.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(c.containment=="document"?0:a(window).scrollLeft())+a(c.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(c.containment=="document"?0:a(window).scrollTop())+(a(c.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(c.containment)&&c.containment.constructor!=Array){var d=a(c.containment);var f=d[0];if(!f){return}var g=d.offset();var e=(a(f).css("overflow")!="hidden");this.containment=[(parseInt(a(f).css("borderLeftWidth"),10)||0)+(parseInt(a(f).css("paddingLeft"),10)||0),(parseInt(a(f).css("borderTopWidth"),10)||0)+(parseInt(a(f).css("paddingTop"),10)||0),(e?Math.max(f.scrollWidth,f.offsetWidth):f.offsetWidth)-(parseInt(a(f).css("borderLeftWidth"),10)||0)-(parseInt(a(f).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(f.scrollHeight,f.offsetHeight):f.offsetHeight)-(parseInt(a(f).css("borderTopWidth"),10)||0)-(parseInt(a(f).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=d}else{if(c.containment.constructor==Array){this.containment=c.containment}}},_convertPositionTo:function(h,f){if(!f){f=this.position}var e=h=="absolute"?1:-1;var g=this.options,d=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,c=(/(html|body)/i).test(d[0].tagName);return{top:(f.top+this.offset.relative.top*e+this.offset.parent.top*e-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(c?0:d.scrollTop()))*e)),left:(f.left+this.offset.relative.left*e+this.offset.parent.left*e-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():c?0:d.scrollLeft())*e))}},_generatePosition:function(l){var c=this.options,j=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=(/(html|body)/i).test(j[0].tagName);var f=l.pageX;var e=l.pageY;if(this.originalPosition){var k;if(this.containment){if(this.relative_container){var i=this.relative_container.offset();k=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]}else{k=this.containment}if(l.pageX-this.offset.click.left<k[0]){f=k[0]+this.offset.click.left}if(l.pageY-this.offset.click.top<k[1]){e=k[1]+this.offset.click.top}if(l.pageX-this.offset.click.left>k[2]){f=k[2]+this.offset.click.left}if(l.pageY-this.offset.click.top>k[3]){e=k[3]+this.offset.click.top}}if(c.grid){var h=c.grid[1]?this.originalPageY+Math.round((e-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY;e=k?(!(h-this.offset.click.top<k[1]||h-this.offset.click.top>k[3])?h:(!(h-this.offset.click.top<k[1])?h-c.grid[1]:h+c.grid[1])):h;var d=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX;f=k?(!(d-this.offset.click.left<k[0]||d-this.offset.click.left>k[2])?d:(!(d-this.offset.click.left<k[0])?d-c.grid[0]:d+c.grid[0])):d}}return{top:(e-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(g?0:j.scrollTop())))),left:(f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:j.scrollLeft())))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(e,c,d){d=d||this._uiHash();a.ui.plugin.call(this,e,[c,d]);if(e=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return a.Widget.prototype._trigger.call(this,e,c,d)},plugins:{},_uiHash:function(c){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.16"});a.ui.plugin.add("draggable","connectToSortable",{start:function(f,c){var g=a(this).data("draggable"),d=g.options,e=a.extend({},c,{item:g.element});g.sortables=[];a(d.connectToSortable).each(function(){var h=a.data(this,"sortable");if(h&&!h.options.disabled){g.sortables.push({instance:h,shouldRevert:h.options.revert});h.refreshPositions();h._trigger("activate",f,e)}})},stop:function(f,d){var c=a(this).data("draggable"),e=a.extend({},d,{item:c.element});a.each(c.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;c.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(f);this.instance.options.helper=this.instance.options._helper;if(c.options.helper=="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",f,e)}})},drag:function(f,d){var c=a(this).data("draggable"),e=this;var g=function(p){var k=this.offset.click.top,j=this.offset.click.left;var m=this.positionAbs.top,h=this.positionAbs.left;var q=p.height,i=p.width;var l=p.top,n=p.left;return a.ui.isOver(m+k,h+j,l,n,q,i)};a.each(c.sortables,function(h){this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return d.helper[0]};f.target=this.instance.currentItem[0];this.instance._mouseCapture(f,true);this.instance._mouseStart(f,true,true);this.instance.offset.click.top=c.offset.click.top;this.instance.offset.click.left=c.offset.click.left;this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top;c._trigger("toSortable",f);c.dropped=this.instance.element;c.currentItem=c.element;this.instance.fromOutside=c}if(this.instance.currentItem){this.instance._mouseDrag(f)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",f,this.instance._uiHash(this.instance));this.instance._mouseStop(f,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}c._trigger("fromSortable",f);c.dropped=false}}})}});a.ui.plugin.add("draggable","cursor",{start:function(f,c){var e=a("body"),d=a(this).data("draggable").options;if(e.css("cursor")){d._cursor=e.css("cursor")}e.css("cursor",d.cursor)},stop:function(e,c){var d=a(this).data("draggable").options;if(d._cursor){a("body").css("cursor",d._cursor)}}});a.ui.plugin.add("draggable","opacity",{start:function(f,c){var e=a(c.helper),d=a(this).data("draggable").options;if(e.css("opacity")){d._opacity=e.css("opacity")}e.css("opacity",d.opacity)},stop:function(e,c){var d=a(this).data("draggable").options;if(d._opacity){a(c.helper).css("opacity",d._opacity)}}});a.ui.plugin.add("draggable","scroll",{start:function(c,d){var e=a(this).data("draggable");if(e.scrollParent[0]!=document&&e.scrollParent[0].tagName!="HTML"){e.overflowOffset=e.scrollParent.offset()}},drag:function(g,c){var f=a(this).data("draggable"),d=f.options,e=false;if(f.scrollParent[0]!=document&&f.scrollParent[0].tagName!="HTML"){if(!d.axis||d.axis!="x"){if((f.overflowOffset.top+f.scrollParent[0].offsetHeight)-g.pageY<d.scrollSensitivity){f.scrollParent[0].scrollTop=e=f.scrollParent[0].scrollTop+d.scrollSpeed}else{if(g.pageY-f.overflowOffset.top<d.scrollSensitivity){f.scrollParent[0].scrollTop=e=f.scrollParent[0].scrollTop-d.scrollSpeed}}}if(!d.axis||d.axis!="y"){if((f.overflowOffset.left+f.scrollParent[0].offsetWidth)-g.pageX<d.scrollSensitivity){f.scrollParent[0].scrollLeft=e=f.scrollParent[0].scrollLeft+d.scrollSpeed}else{if(g.pageX-f.overflowOffset.left<d.scrollSensitivity){f.scrollParent[0].scrollLeft=e=f.scrollParent[0].scrollLeft-d.scrollSpeed}}}}else{if(!d.axis||d.axis!="x"){if(g.pageY-a(document).scrollTop()<d.scrollSensitivity){e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed)}else{if(a(window).height()-(g.pageY-a(document).scrollTop())<d.scrollSensitivity){e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed)}}}if(!d.axis||d.axis!="y"){if(g.pageX-a(document).scrollLeft()<d.scrollSensitivity){e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed)}else{if(a(window).width()-(g.pageX-a(document).scrollLeft())<d.scrollSensitivity){e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)}}}}if(e!==false&&a.ui.ddmanager&&!d.dropBehaviour){a.ui.ddmanager.prepareOffsets(f,g)}}});a.ui.plugin.add("draggable","snap",{start:function(f,c){var e=a(this).data("draggable"),d=e.options;e.snapElements=[];a(d.snap.constructor!=String?(d.snap.items||":data(draggable)"):d.snap).each(function(){var h=a(this);var g=h.offset();if(this!=e.element[0]){e.snapElements.push({item:this,width:h.outerWidth(),height:h.outerHeight(),top:g.top,left:g.left})}})},drag:function(s,p){var f=a(this).data("draggable"),u=f.options;var y=u.snapTolerance;var x=p.offset.left,w=x+f.helperProportions.width,e=p.offset.top,d=e+f.helperProportions.height;for(var v=f.snapElements.length-1;v>=0;v--){var n=f.snapElements[v].left,m=n+f.snapElements[v].width,k=f.snapElements[v].top,q=k+f.snapElements[v].height;if(!((n-y<x&&x<m+y&&k-y<e&&e<q+y)||(n-y<x&&x<m+y&&k-y<d&&d<q+y)||(n-y<w&&w<m+y&&k-y<e&&e<q+y)||(n-y<w&&w<m+y&&k-y<d&&d<q+y))){if(f.snapElements[v].snapping){(f.options.snap.release&&f.options.snap.release.call(f.element,s,a.extend(f._uiHash(),{snapItem:f.snapElements[v].item})))}f.snapElements[v].snapping=false;continue}if(u.snapMode!="inner"){var c=Math.abs(k-d)<=y;var z=Math.abs(q-e)<=y;var h=Math.abs(n-w)<=y;var j=Math.abs(m-x)<=y;if(c){p.position.top=f._convertPositionTo("relative",{top:k-f.helperProportions.height,left:0}).top-f.margins.top}if(z){p.position.top=f._convertPositionTo("relative",{top:q,left:0}).top-f.margins.top}if(h){p.position.left=f._convertPositionTo("relative",{top:0,left:n-f.helperProportions.width}).left-f.margins.left}if(j){p.position.left=f._convertPositionTo("relative",{top:0,left:m}).left-f.margins.left}}var g=(c||z||h||j);if(u.snapMode!="outer"){var c=Math.abs(k-e)<=y;var z=Math.abs(q-d)<=y;var h=Math.abs(n-x)<=y;var j=Math.abs(m-w)<=y;if(c){p.position.top=f._convertPositionTo("relative",{top:k,left:0}).top-f.margins.top}if(z){p.position.top=f._convertPositionTo("relative",{top:q-f.helperProportions.height,left:0}).top-f.margins.top}if(h){p.position.left=f._convertPositionTo("relative",{top:0,left:n}).left-f.margins.left}if(j){p.position.left=f._convertPositionTo("relative",{top:0,left:m-f.helperProportions.width}).left-f.margins.left}}if(!f.snapElements[v].snapping&&(c||z||h||j||g)){(f.options.snap.snap&&f.options.snap.snap.call(f.element,s,a.extend(f._uiHash(),{snapItem:f.snapElements[v].item})))}f.snapElements[v].snapping=(c||z||h||j||g)}}});a.ui.plugin.add("draggable","stack",{start:function(f,g){var d=a(this).data("draggable").options;var c=a.makeArray(a(d.stack)).sort(function(i,h){return(parseInt(a(i).css("zIndex"),10)||0)-(parseInt(a(h).css("zIndex"),10)||0)});if(!c.length){return}var e=parseInt(c[0].style.zIndex)||0;a(c).each(function(h){this.style.zIndex=e+h});this[0].style.zIndex=e+c.length}});a.ui.plugin.add("draggable","zIndex",{start:function(f,c){var e=a(c.helper),d=a(this).data("draggable").options;if(e.css("zIndex")){d._zIndex=e.css("zIndex")}e.css("zIndex",d.zIndex)},stop:function(e,c){var d=a(this).data("draggable").options;if(d._zIndex){a(c.helper).css("zIndex",d._zIndex)}}})})(jQuery);