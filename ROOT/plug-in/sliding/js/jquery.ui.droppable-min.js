(function(a,b){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var d=this.options,c=d.accept;this.isover=0;this.isout=1;this.accept=a.isFunction(c)?c:function(e){return e.is(c)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[d.scope]=a.ui.ddmanager.droppables[d.scope]||[];a.ui.ddmanager.droppables[d.scope].push(this);(d.addClasses&&this.element.addClass("ui-droppable"))},destroy:function(){var c=a.ui.ddmanager.droppables[this.options.scope];for(var d=0;d<c.length;d++){if(c[d]==this){c.splice(d,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(c,d){if(c=="accept"){this.accept=a.isFunction(d)?d:function(e){return e.is(d)}}a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(d){var c=a.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}(c&&this._trigger("activate",d,this.ui(c)))},_deactivate:function(d){var c=a.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}(c&&this._trigger("deactivate",d,this.ui(c)))},_over:function(d){var c=a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0]){return}if(this.accept.call(this.element[0],(c.currentItem||c.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",d,this.ui(c))}},_out:function(d){var c=a.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0]){return}if(this.accept.call(this.element[0],(c.currentItem||c.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",d,this.ui(c))}},_drop:function(f,c){var e=c||a.ui.ddmanager.current;if(!e||(e.currentItem||e.element)[0]==this.element[0]){return false}var d=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var g=a.data(this,"droppable");if(g.options.greedy&&!g.options.disabled&&g.options.scope==e.options.scope&&g.accept.call(g.element[0],(e.currentItem||e.element))&&a.ui.intersect(e,a.extend(g,{offset:g.element.offset()}),g.options.tolerance)){d=true;return false}});if(d){return false}if(this.accept.call(this.element[0],(e.currentItem||e.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",f,this.ui(e));return this.element}return false},ui:function(c){return{draggable:(c.currentItem||c.element),helper:c.helper,position:c.position,offset:c.positionAbs}}});a.extend(a.ui.droppable,{version:"1.8.16"});a.ui.intersect=function(j,o,f){if(!o.offset){return false}var g=(j.positionAbs||j.position.absolute).left,e=g+j.helperProportions.width,c=(j.positionAbs||j.position.absolute).top,q=c+j.helperProportions.height;var k=o.offset.left,d=k+o.proportions.width,i=o.offset.top,p=i+o.proportions.height;switch(f){case"fit":return(k<=g&&e<=d&&i<=c&&q<=p);break;case"intersect":return(k<g+(j.helperProportions.width/2)&&e-(j.helperProportions.width/2)<d&&i<c+(j.helperProportions.height/2)&&q-(j.helperProportions.height/2)<p);break;case"pointer":var m=((j.positionAbs||j.position.absolute).left+(j.clickOffset||j.offset.click).left),n=((j.positionAbs||j.position.absolute).top+(j.clickOffset||j.offset.click).top),h=a.ui.isOver(n,m,i,k,o.proportions.height,o.proportions.width);return h;break;case"touch":return((c>=i&&c<=p)||(q>=i&&q<=p)||(c<i&&q>p))&&((g>=k&&g<=d)||(e>=k&&e<=d)||(g<k&&e>d));break;default:return false;break}};a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(g,d){var k=a.ui.ddmanager.droppables[g.options.scope]||[];var h=d?d.type:null;var f=(g.currentItem||g.element).find(":data(droppable)").andSelf();droppablesLoop:for(var e=0;e<k.length;e++){if(k[e].options.disabled||(g&&!k[e].accept.call(k[e].element[0],(g.currentItem||g.element)))){continue}for(var c=0;c<f.length;c++){if(f[c]==k[e].element[0]){k[e].proportions.height=0;continue droppablesLoop}}k[e].visible=k[e].element.css("display")!="none";if(!k[e].visible){continue}if(h=="mousedown"){k[e]._activate.call(k[e],d)}k[e].offset=k[e].element.offset();k[e].proportions={width:k[e].element[0].offsetWidth,height:k[e].element[0].offsetHeight}}},drop:function(e,c){var d=false;a.each(a.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&a.ui.intersect(e,this,this.options.tolerance)){d=d||this._drop.call(this,c)}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(e.currentItem||e.element))){this.isout=1;this.isover=0;this._deactivate.call(this,c)}});return d},dragStart:function(c,d){c.element.parents(":not(body,html)").bind("scroll.droppable",function(){if(!c.options.refreshPositions){a.ui.ddmanager.prepareOffsets(c,d)}})},drag:function(c,d){if(c.options.refreshPositions){a.ui.ddmanager.prepareOffsets(c,d)}a.each(a.ui.ddmanager.droppables[c.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var f=a.ui.intersect(c,this,this.options.tolerance);var h=!f&&this.isover==1?"isout":(f&&this.isover==0?"isover":null);if(!h){return}var g;if(this.options.greedy){var e=this.element.parents(":data(droppable):eq(0)");if(e.length){g=a.data(e[0],"droppable");g.greedyChild=(h=="isover"?1:0)}}if(g&&h=="isover"){g.isover=0;g.isout=1;g._out.call(g,d)}this[h]=1;this[h=="isout"?"isover":"isout"]=0;this[h=="isover"?"_over":"_out"].call(this,d);if(g&&h=="isout"){g.isout=0;g.isover=1;g._over.call(g,d)}})},dragStop:function(c,d){c.element.parents(":not(body,html)").unbind("scroll.droppable");if(!c.options.refreshPositions){a.ui.ddmanager.prepareOffsets(c,d)}}}})(jQuery);