var menujson=null;var datajson=null;var iconjson=null;var totalnum=null;var DATA=new Object();var iconCookieKey="iconCookieKey";var iconCookieKeyForSlider="iconCookieKeyForSlider";var cookieParam={expires:30};var defaultIconForSlider=[];function dataFlush(){$.ajax({url:"loginController.do?getPrimaryMenuForWebos",datatype:"json",async:false,type:"post",success:function(data){var menu;menu=eval("("+data+")");var array=menu.msg.split("$$");menujson=array[0];menujson=eval("("+menujson+")");iconjson=array[1];iconjson=eval("("+iconjson+")");datajson=array[2];datajson=eval("("+datajson+")");var totalnum1=array[3];totalnum=totalnum1-1;calcuIconJson()}})}function calcuIconJson(){var l=$.cookie(iconCookieKey);var q=$.cookie(iconCookieKeyForSlider);if(l){var t=new Array();var n={};for(var r in iconjson){n[r]=new Array()}var p=l.split("|");$.each(p,function(c,b){var d=b.split(":")[0];var a=b.split(":")[1]?b.split(":")[1].split("@"):"";$.each(a,function(f,e){if(e){n[d].push(e);t.push(e)}})});if(q){DATA.sApp={};defaultIconForSlider=new Array();var s=q.split("@");$.each(s,function(c,a){if(a){for(var b in datajson.app){if(a==b){DATA.sApp[b]=datajson.app[b];break}}defaultIconForSlider.push(a);t.push(a)}})}for(var o in iconjson){for(var k in iconjson[o]){var m=iconjson[o][k];if(t.indexOf(m)==-1){n[o].push(m)}}}iconjson=n}}Util={formatmodel:function(g,e){for(var f in e){var h=new RegExp("{"+f+"}","g");g=g.replace(h,e[f])}return g}};Panel=function(){return me={hitTest:function(f,g,h){var j,i;return !(g<(j=f.offset().left)||h<(i=f.offset().top)||g>j+f.width()||h>i+f.height())},getIdx:function(d){var c=0;while(d=d.prev()){c++}return c},unSelecte:function(){return window.getSelection?function(){window.getSelection().removeAllRanges()}:function(){document.selection.empty()}}()}}();Body=function(b){dataFlush();return b={init:function(){b.create();b.bindEvent()},create:function(){b.box=$("body");b.setStyle()},bindEvent:function(){function d(c){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty()}function a(c){$(document).unbind("mousemove",d).unbind("mouseup",a)}$(document).bind("mousedown",function(){$(document).bind("mousemove",d).bind("mouseup",a)})},addPanel:function(a){b.box.append(a)},setStyle:function(){b.box.css({backgroud:"none repeat scroll 0 0 transparent",display:"block",height:"500px"})}}}();Desktop=function(b){return b={init:function(){b.create();return b},create:function(){b.box=$("<div id='desktop'  style='position: static;'></div>");Body.addPanel(b.box)},addPanel:function(a){b.box.append(a)},show:function(){b.box.show()},hide:function(){b.box.hide()},setMenu:function(){var a=[[{text:"显示桌面",func:function(){}},{text:"关闭所有",func:function(){Windows.closeAllWindow()}},{text:"锁屏",func:function(){}}],[{text:"系统设置",func:function(){}},{text:"主题设置",func:function(){Windows.openSys({id:"themSetting",title:"设置主题",width:650,height:500,content:document.getElementById("themeSetting_wrap")})}},{text:"图标设置",data:[[{text:"大图标",func:function(){Deskpanel.desktopsContainer.removeClass("desktopSmallIcon")}},{text:"小图标",func:function(){Deskpanel.desktopsContainer.addClass("desktopSmallIcon")}}]]}],[{text:"注销",func:function(){}}]];b.box.smartMenu(a,{name:"image"})}}}();Deskpanel=function(n){var o="<div id='desktopWrapper'></div>";var p="<div id='desktopsContainer' class='desktopsContainer'	>";var m="<div class='desktopContainer' index='{index}' >";var j="<div class='appListContainer' customacceptdrop='{index}' index='{index}' _olddisplay='block' >";var l=0,i=15,k={left:0,top:0,right:0,bottom:120};return n={init:function(b,a){n.create();n.addIcons(b);n.space(k);n.refresh(a);n.bindEvent();n.addCurrnet(l);return n},create:function(){n.box=$(o);n.desktopsContainer=$(p);n.createDesktopsContainer(i);n.box.append(n.desktopsContainer);n.box.css({left:"73px",right:"0px"});n.desktopsContainer.css("left",73);Desktop.addPanel(n.box);n.Icon=[]},bindEvent:function(){n.desktopsContainer.find(".appListContainer").each(function(){var b=$(this);var a=b.attr("index");b.sortable({items:".appButton",connectWith:".dock_middle",opacity:"0.6",start:function(d,c){},stop:function(e,d){var c=d.item.parent();if(c.hasClass("dock_middle")){d.item.removeAttr("style")}Deskpanel.switchCurrent(a);Deskpanel.refreshIcon()}}).disableSelection()});$(window).resize(n.refresh)},createDesktopsContainer:function(a){if(a&&a!=0){for(var b=1;b<=a;b++){n.desktopsContainer.append(n.addContainer(b))}}},addContainer:function(b){var a=n.createDesktopContainer(b);var c=n.createDesktopAppListener(b);a.append(c);return a},createDesktopContainer:function(a){return $(Util.formatmodel(m,{index:a-1}))},createDesktopAppListener:function(a){return $(Util.formatmodel(j,{index:a-1}))},addIcons:function(a){for(var b in a){var c=b.substring(b.length-1,b.length);n.addIcon(a[b],c)}},addIcon:function(a,c){if(a){if($.isArray(a)){$.each(a,function(){n.addIcon(this.valueOf(),c)});return n}var b=typeof a=="string"?appIcon_t1(a):a;n.Icon.push(b);n.box.find("div[customacceptdrop='"+parseInt(c-1)+"']").append(b.box)}},addCurrnet:function(a){n.desktopsContainer.find(".desktopContainer[index='"+a+"']").addClass("desktop_current")},removeCurrent:function(a){n.desktopsContainer.find(".desktopContainer[index='"+a+"']").removeClass("desktop_current")},switchCurrent:function(a){var b=n.desktopsContainer;b.find(".desktopContainer[index='"+a+"']").addClass("desktop_current").siblings().removeClass("desktop_current")},space:function(a){("top" in a)&&(typeof a.top=="string"?n.spaceTop+=a.top:n.spaceTop=+a.top||0);("left" in a)&&(typeof a.left=="string"?n.spaceLeft+=a.top:n.spaceLeft=+a.left||0);("right" in a)&&(typeof a.right=="string"?n.spaceRight+=a.top:n.spaceRight=+a.right||0);("bottom" in a)&&(typeof a.bottom=="string"?n.spaceBottom+=a.top:n.spaceBottom=+a.bottom||0);return n},refresh:function(f){var a=$(window).width(),e=$(window).height();n.width=a-n.spaceRight-n.spaceLeft;n.height=e-n.spaceTop-n.spaceBottom;var b=n.desktopsContainer.find(".desktopContainer");var c=b.find(".appListContainer");$(b).each(function(g){$(this).css({left:n.width*g,height:n.height-n.spaceBottom})});$("#zoomWallpaperGrid,#zoomWallpaper").width(a).height(e);var d=n.row=~~(n.height/112);n.desktopsContainer.css({left:n.spaceLeft,top:n.spaceTop,width:n.width,height:n.height});c.each(function(){$(this).css({width:n.width,height:n.height,"margin-left":28,"margin-top":46,display:"block"})});n.refreshIcon(f)},refreshIcon:function(b){var d=~~(n.height/112);var e=1;var c="";n.desktopsContainer.find(".appListContainer").each(function(){c+="Icon"+e+":";var h=$(this).children();for(var t=0;t<h.length;t++){var f=~~(t/d),g=t%d;$(h[t]).css({left:f*142,top:g*112});var s=$(h[t]).attr("id").replace("icon_app_","");s=s.substring(0,s.indexOf("_"));c+=s+"@"}c+="|";e++});if(!b){$.cookie(iconCookieKey,c,cookieParam);var a="";$("#dockContainer").find(".dock_middle").each(function(){var f=$(this).children();for(var h=0;h<f.length;h++){var g=$(f[h]).attr("id").replace("icon_app_","");g=g.substring(0,g.indexOf("_"));a+=g+"@"}});$.cookie(iconCookieKeyForSlider,a,cookieParam)}},moveIconTo:function(a,c){var b=(Panel.getIdx(a.box));if(idx>c){n.box.children(".appListContainer[index='1']").append(a.box,c)}else{if(idx<c){n.box.children(".appListContainer[index='1']").append(a.box,c+1)}}n.Icon.splice(idx,1);n.Icon.splice(c,0,a);n.refresh()},removeIcon:function(a){var b=(Panel.getIdx(a.box));n.Icon.splice(b,1);a.box.remove();n.refresh()},getIdx:function(a,b){a-=n.spaceLeft+n.spaceRight;b-=n.spaceTop+n.spaceBottom;return(~~(a/142))*n.row+(~~(b/112))}}}();Sidebar=function(h){var i="<div class='dock_tool_list' id='dockToolList' >";var j="<div class='dock_tool_item'></div>";var g="<a title='{title}' cmd='{cmd}'	class='dock_tool_icon dock_tool_{key}' href='###'></a>";var f=$.Class({init:function(a){this.create(a.location)},create:function(a){this.box=$("<div id='"+a+"Bar'></div>");Desktop.addPanel(this.box)},addPanel:function(a){this.box.append(a.pbox)}});return h={init:function(a){h.create(a.location);h.movePanel();h.addIcon(a.Icon);h.addToolList();h.initDrag()},create:function(a){h.leftPanel=f({location:"left"});h.rightPanel=f({location:"right"});h.topPanel=f({location:"top"});h.box=$('<div class="dock_middle"></div>');h.pbox=$('<div id="dockContainer" class="dock_container " style="z-index: 10;"> </div>');h[a+"Panel"].addPanel(h.pbox);h.location=a;h.Icon=[];h.pbox.addClass("dock_pos_"+a);h.pbox.append(h.box);h.leftPanel.box.append(h.pbox);Desktop.addPanel(h.leftPanel.box);Desktop.addPanel(h.rightPanel.box);Desktop.addPanel(h.topPanel.box);h.createStartTool();h.createPinyinTool();h.createSoundTool();h.createSettingTool();h.createThemeTool()},movePanel:function(){dockEffectBox.init();h.pbox.bind("mousedown",function(k){if($(k.target).css("cursor")=="pointer"){return}$(document).bind({mousemove:b,mouseup:d});k.preventDefault();k.stopPropagation()});var e=0,c,a,l;function b(p){Panel.unSelecte();if(!e){e=1;c=Desktop.box.outerWidth();a=Desktop.box.outerHeight();dockEffectBox.show()}var k=p.pageX;var o=p.pageY;if(o<a*0.2){l="top"}else{if(k<c*0.5){l="left"}else{l="right"}}}function d(){$(document).unbind("mousemove",b).unbind("mouseup",d);e=0;dockEffectBox.hide();h[l+"Panel"].addPanel(h);h.location=l;h.addStyle();Deskpanel.refreshIcon()}},addToolList:function(){var d=$(i);var a=$(j);var b=$(j);var c=$(j);a.append(h.pinyin).append(h.sound);b.append(h.settingtool).append(h.theme);c.append(h.start);d.append(a).append(b).append(c);h.box.append(d)},createStartTool:function(){h.start=$("<a title='点击这里开始' class='dock_tool_icon dock_tool_start'	href='javascript:void(0);'></a>");h.start.powerFloat({eventType:"click",offsets:{x:a,y:-100},target:$("#startMenuContainer")});function a(){var b=h.pbox.parent();var d=b.attr("id");var c=d.substring(0,d.length-3);if(c=="left"){if(b.css("height").replace("px","")<=825){return -60}else{return 60}}else{if(c=="top"){return 0}else{return 60}}}},createPinyinTool:function(){h.pinyin=$(Util.formatmodel(g,{cmd:"Pinyin",title:"输入法",key:"pinyin"}))},createSoundTool:function(){var a=h.sound=$(Util.formatmodel(g,{cmd:"Sound",title:"静音",key:"sound"}));a.toggle(function(){$(this).addClass("dock_tool_sound_mute").attr("title","取消静音")},function(){$(this).removeClass("dock_tool_sound_mute").attr("titile","静音")})},createSettingTool:function(){h.settingtool=$(Util.formatmodel(g,{cmd:"Setting",title:"系统设置",key:"setting"}))},createThemeTool:function(){var a=h.theme=$(Util.formatmodel(g,{cmd:"Theme",title:"主题设置",key:"theme"}));h.bindTheme()},bindTheme:function(){var a=$("#themeSetting_wrap");h.theme.click(function(){Windows.openSys({id:"themSetting",title:"设置主题",width:650,height:500,content:document.getElementById("themeSetting_wrap")})});$("a",a).live("click",function(){var d=$(this);var e=d.attr("themeid");var b=e.substring(e.indexOf("_")+1,e.length);var c=$(window).height();var m=$(window).width();$("#zoomWallpaper").attr("src","plug-in/sliding/images/bg/"+b+".jpg").width(m).height(c);$.cookie("myskin","plug-in/sliding/images/bg/"+b+".jpg",cookieParam);$("#zoomWallpaperGrid").width(m).height(c);$("a",a).removeClass("themeSetting_selected");d.addClass("themeSetting_selected")})},addIcon:function(b,d){if(b){if($.isArray(b)){$.each(b,function(){h.addIcon(this.valueOf())});return h}if(h.Icon.length==6){var a=h.Icon[5];h.Icon.length=6;$(a.box).remove();return}var c=typeof b=="string"?appIcon_t2(b):b;if(d!=undefined){h.Icon.splice(d,0,c);h.box.append(c.box,d)}else{h.Icon.push(c);h.box.append(c.box)}}},removeIcon:function(a){var b=(Panel.getIdx(a.box));h.Icon.splice(b,1);$(a.box).remove()},getIdx:function(b,c){var a=h.pbox.offset();switch(h.location){case"top":return ~~((b-a.left)/142);case"left":case"right":return ~~((c-a.top)/112)}},addStyle:function(){h.pbox.removeClass().addClass("dock_container dock_pos_"+h.location);switch(h.location){case"top":h.topPanel.box.css({width:"100%",height:"73px"}).show();h.leftPanel.box.css({width:"0",height:"0"}).hide();h.rightPanel.box.css({width:"0%",height:"0"}).hide();Deskpanel.box.css({left:0,right:0});Deskpanel.desktopsContainer.css("top",73);break;case"left":h.leftPanel.box.css({width:"73px",height:"100%"}).show();h.topPanel.box.css({width:"0",height:"0"}).hide();h.rightPanel.box.css({width:"0%",height:"0"}).hide();Deskpanel.box.css({left:"73px",right:"0px"});Deskpanel.desktopsContainer.css("left",73);break;case"right":h.rightPanel.box.css({width:"73px",height:"100%"}).show();h.leftPanel.box.css({width:"0",height:"0"}).hide();h.topPanel.box.css({width:"0",height:"0"}).hide();Deskpanel.box.css({left:0,right:73});Deskpanel.desktopsContainer.css("top",0);break}},initDrag:function(){var a=Deskpanel.desktopsContainer.find(".appListContainer");h.box.sortable({connectWith:a,items:".appButton",opacity:"0.6",scroll:true,start:function(c,b){},stop:function(d,c){var e=c.item;var b=e.parent();if(b.hasClass("appListContainer")){e.css("position","absolute")}Deskpanel.refreshIcon()}}).disableSelection()}}}();Navbar=function(p){var q="<div  id='navbar' class='no_sysbtn' ></div>";var o="<div class='indicator_container nav_current_{index}'	id='indicatorContainer'></div>";var m="<div class='indicator indicator_header' id='navbarHeaderImg' cmd='user' title='{title}'><img src='{url}' alt='{title}' class='indicator_header_img' ></div>";var k="<a class='indicator indicator_{num}' href='###' cmd='switch' index='{index}'	title='{name}'><span class='indicator_icon_bg'></span><span class='indicatorhover indicator_icon_{num}'>{num}</span></a>";var s="<a class='indicator indicator_{key}' href='###' cmd='{key}' title='{title}'></a>";var r=totalnum+1,l=1,n="请登录",t="plug-in/sliding/images/jeecg.png";return p={init:function(){p.create();p.bindEvent();p.setPosition()},bindEvent:function(){p.innerbox.find("a[cmd='switch']").click(function(){var d=$(this);var a=d.attr("cmd[switch]");var e=$.trim(p.innerbox.attr("class"));var b=parseInt(e.substring(e.lastIndexOf("_")+1));var c=parseInt(d.attr("index"));p.bindSwitchDesktopAnimate(c,b);p.innerbox.removeClass().addClass("indicator_container nav_current_"+parseInt(c+1))});p.box.draggable()},bindSwitchDesktopAnimate:function(a,d){var e=0;var d=parseInt(d-1);if(a<d){e=-2000}else{e=2000}var c=Deskpanel.desktopsContainer.find(".desktopContainer[index="+d+"]");c.removeClass("desktop_current");c.stop().animate({left:e},"normal",function(){});var b=Deskpanel.desktopsContainer.find(".desktopContainer[index="+a+"]");b.removeClass("desktop_current").addClass("desktop_current");b.stop().animate({left:0},"normal",function(){})},create:function(){p.box=$(q);p.box.append("<div class='indicator_wrapper'></div>");p.box.find(".indicator_wrapper").append(p.createInnerbox());Desktop.addPanel(p.box)},createInnerbox:function(){var a=p.innerbox=$(Util.formatmodel(o,{index:l}));a.append(p.createUser());p.createIndicator();a.append(p.createSearch());a.append(p.createManage());return a},createUser:function(){var a=p.userbox=$(Util.formatmodel(m,{url:t,title:n}));a.click(function(){alert("It's  xiaofan ")});return a},createIndicator:function(){var a=0;$.each(menujson,function(d,c){var b=Util.formatmodel(k,{num:a+1,id:c.id,index:a,name:c.name});a++;p.innerbox.append(b)})},createSearch:function(){var i=p.search=$(Util.formatmodel(s,{key:"search",title:"搜索"}));var d=$("<div class='pagelet_search_bar' style='display: none; '></div>");var f=$("<input>",{"class":"pagelet_search_input",value:"搜索功能模块和应用..."});var c=$("<input>",{id:"pageletSearchButton","class":"pagelet_search_button",title:"搜索..."});var g=$("<div class='pagelet_search_suggest' id='pagelet_search_suggest'style='display: none;' ></div>");var e=$("<ul id='sb_resultBox'  style='display: block;'></ul>");var a=$("<div idx='-1' class='sb_resultList fsb_resultList sb_page'><a href='#'><span class='sb_pageTxt'><span id='sb_resultBox_key' class='sb_resultBox_key'>s</span>-在“百度”搜索...</span></a>  </div>");var b=$("<div idx='-2' class='sb_resultList fsb_resultList sb_app'><a href='#'><span class='sb_appTxt'><span id='sb_resultBox_key'  class='sb_resultBox_key'>s</span>-去系统应用搜搜...</span></a></div>");g.append(e).append(a).append(b);d.append(f).append(c);Body.addPanel(d);Body.addPanel(g);i.powerFloat({width:d.width(),eventType:"click",offsets:{x:5,y:20},position:"3-1",target:d,showCall:function(){var j=d.offset();g.offset({top:j.top+32,left:j.left})}});f.focus(function(){$(this).val("")}).blur(function(){h();var j=$(this).val();$(this).val("搜索功能模块和应用...");$(".fsb_resultList").show()}).keyup(function(){var j=$(this);var v=j.val();$(".sb_resultBox_key").html(v);if(v=="o"){$("#sb_resultBox").append("<li class='sb_resultList' idx='2232'><a href='#' title='owlhr'><div class='listInner'>新奥尔</div></a></li>").show();g.show()}if(v==""){g.hide()}});var h=function(){var j=f.val();if(j==""){g.hide()}else{g.show()}};return i},createManage:function(){var a=p.manage=$(Util.formatmodel(s,{key:"manage",title:"全局视图"}));a.click(function(){if(appManagerPanel){appManagerPanel.show();appManagerPanel.showItemsTurn();appManagerPanel.resize();Desktop.hide()}});return a},setPosition:function(){var b=$(window).width();var a=p.box.width();p.box.css("left",parseInt(b/2)-parseInt(a/2))}}}();appManagerPanel=function(n){var r="<div id='appManagerPanel' class='appManagerPanel' style='display: none; '></div>";var l="<a class='aMg_close' href='###'></a>";var k="<div class='aMg_dock_container' index='{totalnum}' customacceptdrop='1'></div>";var q="<div class='aMg_line_x'></div>";var s="<div class='aMg_line_y'></div>";var p="<div class='aMg_folder_container'></div>";var m="<div class='folderItem'><div class='folder_bg folder_bg{key}'></div><div class='folderOuter' index='{index}' customacceptdrop='{key}'></div></div>";var o="<div class='folderInner' style='height: 90%; overflow-x: hidden; overflow-y: hidden; ' index='{index}' customacceptdrop='{key}'></div>";var t="<div class='scrollBar' style='margin-top: 0px; height: 0px; display: none;' _olddisplay='block'></div>";return n={init:function(){n.create();n.bindEvent();n.resize()},create:function(){n.box=$(r);n.aMg_close=$(l);n.box.append(n.aMg_close).append(n.cSidebarApp()).append(q).append(n.cDeskApp());Body.addPanel(n.box)},cSidebarApp:function(){n.aMg_dock_container=$(k);n.loadSidebarData();return n.aMg_dock_container},loadSidebarData:function(){var a=Sidebar.box.find(".appButton").clone().appendTo(n.aMg_dock_container)},cDeskApp:function(){n.aMg_App_container=$(p);n.loadDeskData();return n.aMg_App_container},loadDeskData:function(){Deskpanel.desktopsContainer.find(".appListContainer").each(function(){var d=$(this);var e=parseInt(d.attr("index"));var a=$(Util.formatmodel(m,{index:e,key:e+1}));var c=$(Util.formatmodel(o,{index:e,key:e+1}));var b=a.find(".folderOuter");d.children().each(function(){c.append(appIcon_amg1($(this).attr("fid")).box)});b.append(c);b.append(t);if(e!=0){b.after(s)}n.aMg_App_container.append(a)})},bindEvent:function(){var b=$(".folderItem",n.box);n.aMg_close.click(function(){n.hide();b.removeClass("folderItem_turn");Desktop.show()});var a=b.find(".folderInner");a.sortable({items:".appButton",connectWith:[a,n.aMg_dock_container],opacity:"0.6",stop:function(f,e){var c=e.item;var d=c.parent();if(c.parent().hasClass("aMg_dock_container")){c.removeClass("amg_folder_appbutton")}}}).disableSelection();n.aMg_dock_container.sortable({items:".appButton",connectWith:".folderInner",opacity:"0.6",stop:function(c,e){a=e.item;var d=a.parent();if(d.hasClass("folderInner")){a.addClass("amg_folder_appbutton")}}}).disableSelection()},showItemsTurn:function(){$(".folderItem",n.box).show().addClass("folderItem_turn")},show:function(){n.box.show()},hide:function(){n.box.hide()},resize:function(){var a=$(window).height()-60;n.aMg_App_container.height(a)}}}();dockEffectBox=function(l){var j="<div id='docktop' class='dock_drap_effect dock_drap_effect_top ' style='display: none;' _olddisplay='block'></div>";var i="<div id='dockleft' class='dock_drap_effect dock_drap_effect_left' style='display: none;'></div>";var g="<div id='dockright' class='dock_drap_effect dock_drap_effect_right' style='display: none;'></div>";var k="<div class='dock_drap_proxy' style='display: none; left: -79px; top: -260px;'></div>";var h="<div id='dockmask' class='dock_drap_mask' style='display: none;'><div class='dock_drop_region_top' cmd='region'name='top'></div><div class='dock_drop_region_left' cmd='region' name='left'></div><div class='dock_drop_region_right' cmd='region' name='right'></div></div>";return l={init:function(){l.create()},create:function(){l.tbox=$(j);l.lbox=$(i);l.rbox=$(g);l.proxybox=$(k);l.maskbox=$(h);l.addDesktop()},addDesktop:function(){Desktop.addPanel(l.tbox);Desktop.addPanel(l.lbox);Desktop.addPanel(l.rbox);Desktop.addPanel(l.proxybox);Desktop.addPanel(l.maskbox)},show:function(){l.tbox.show();l.lbox.show();l.rbox.show();l.maskbox.show()},hide:function(){l.tbox.hide();l.lbox.hide();l.rbox.hide();l.maskbox.hide()}}}();BottomBar=function(l){var k="<div id='bottomBar' class='bottomBar' style='z-index: 12;'></div>";var j="<div id='taskNextBox' class='taskNextBox' _olddisplay='' style='display: none;'><a id='taskNext' class='taskNext' hidefocus='true' href='#'></a></div>";var i="<div id='taskPreBox' class='taskPreBox' _olddisplay='' style='display: none;'><a id='taskPre' class='taskPre' hidefocus='true' href='#'></a></div>";var m="<div id='taskContainer' class='taskContainer' style=''></div>";var h="<div class='bottomBarBg'></div>";var n="<div class='bottomBarBgTask'></div>";return l={init:function(){l.create();Desktop.addPanel(l.box);Desktop.addPanel(h);Desktop.addPanel(n)},create:function(){var a=l.box=$(k);l.innerbox=$("<div id='taskContainerInner' class='taskContainerInner' style=''></div>");l.taskContainner=$(m);l.taskContainner.append(l.innerbox);a.append(j);a.append(l.taskContainner);a.append(i)},addItem:function(b){l.innerbox.append(b);var d=l.innerbox.children().length;var a=b.attr("id");var c=b.width()*d+20;l.taskContainner.width(c);l.innerbox.css({"margin-right":0,width:(c)});l.setCurrent(a)},getItem:function(a){return l.innerbox.find("a[tid='"+a+"']")},getItemNum:function(){return l.innerbox.children().size()},setCurrent:function(a){l.addCurrent(a);l.removeItemSibling(a)},addCurrent:function(a){l.innerbox.find("#"+a).addClass("taskCurrent")},removeItemSibling:function(a){l.innerbox.find("#"+a).siblings().removeClass("taskCurrent")},getALLItemID:function(){var b=l.innerbox.children();var a=[];b.each(function(){var c=$(this).attr("id");c=c.substring(c.lastIndexOf("_")+1,c.length);a.push(c)});return a}}}();Task=$.Class({init:function(b){this.create(b);this.rightMenu()},create:function(i){var h=$("<div>",{"class":"taskGroup taskGroupAnaWidth",id:"taskGroup_"+i.id+"_"+i.id});var k=$("<div>",{"class":"taskItemIcon"});$("<img src='plug-in/sliding/icon/"+i.icon+"'/><div class='taskItemIconState'></div>").appendTo(k);var j=$("<div>",{"class":"taskItemTxt",text:i.title});var g=$("<div>",{"class":"taskItemBox",});var l=$("<a>",{"class":"taskItem fistTaskItem",href:"#",id:"taskItem_"+i.id,title:i.title,tid:i.id,appid:i.id+"_"+i.id});l.append(k).append(j);g.append(l);h.append(g);this.box=h},rightMenu:function(){var b=[[{text:"最大化",func:function(){var a=$(this).attr("id");wid=a.substring(a.lastIndexOf("_")+1,a.length);$.dialog.list[wid].show().max()}},{text:"最小化",func:function(){}}],[{text:"关闭",func:function(){var a=$(this).attr("id");wid=a.substring(a.lastIndexOf("_")+1,a.length);$.dialog.list[wid].close();$("#"+a).remove()}}]];this.box.smartMenu(b,{name:"taskmenu",offsetX:-100,offsetY:-100})}});Windows=function(b){return b={showWindow:function(j){var k=$.dialog.list;var l=BottomBar.getALLItemID();var o=l.length;var m=k[j];function p(){var e=null;for(var c in $.dialog.list){c=$.dialog.list[c];var d=c.DOM.wrap;var f=$(d);if(f.css("visibility")=="visible"){if(e==null){e=c}else{e=f[0].style.zIndex>e.DOM.wrap[0].style.zIndex?c:e}}}if(e){$.dialog.focus.DOM.border.removeClass("ui_state_focus");$.dialog.focus=e;e.DOM.border.addClass("ui_state_focus")}}var n=m.DOM.wrap;var a=$(n);if(o>1){if(a.css("visibility")=="hidden"){m.show().zindex()}else{if(!m.DOM.border.hasClass("ui_state_focus")){m.zindex()}else{m.hide();p()}}}else{if(a.css("visibility")=="visible"){m.hide()}else{m.show()}}},hideWindow:function(a){$.dialog.list[a].hide()},closeMinTask:function(a){$("#taskGroup_"+a+"_"+a).remove()},closeAllWindow:function(){var d=$.dialog.list;for(var a in d){d[a].close()}},openSys:function(a){$.dialog({id:a.id,title:a.title,width:a.width,height:a.height,max:false,min:false,content:a.content})},openApp:function(s,n,t,o,r,l){var m=BottomBar.innerbox;var a=BottomBar.getItem(s);if(a.length==1){return}else{var p=BottomBar.getItemNum();if(p>7&&p!=0){return false}var q=Task({id:s,title:n,icon:o});BottomBar.addItem(q.box);q.box.click(function(){b.showWindow(s);BottomBar.setCurrent(q.box.attr("id"))});$.dialog({id:s,lock:false,zIndex:1000+getDialogLength(),width:r,height:l,title:n,opacity:0.3,min:false,content:"url:"+t,close:function(){b.closeMinTask(s)}}).zindex()}}}}();function getDialogLength(){var c=0;for(var d in $.dialog.list){c++}return c}appIcon_amg=$.Class({create:function(b){this.box=$("<div  type='"+b+"'  class='appButton amg_folder_appbutton' ></div>")}});appIcon_t0=$.Class({create:function(b){this.box=$("<div type='"+b+"'  class='appButton'></div>");this.setRightMenu()},setRightMenu:function(){}});appIcon_amg1=appIcon_amg.extend({init:function(b){this.fid=b;this.app=datajson.app[b];this.tx="app";this.create();this.bindEvent()},create:function(){this._super(1);this.box.attr({id:"icon_app_"+this.app.appid+"_"+this.app.asc,appid:this.app.appid,fileid:this.app.appid,title:this.app.name,url:this.app.url,uid:"app_"+this.app.appid});var k=$("<div>",{id:"icon_app_"+this.app.appid+"_"+this.app.asc+"_icon_div","class":"appButton_appIcon"});k.append($("<img>",{alt:this.app.name,src:this.app.icon,"class":"appButton_appIconImg",id:"icon_app_"+this.app.appid+"_"+this.app.asc+"_img"}));var g=$("<div class='appButton_appName'></div>");var h=$("<div>",{"class":"appButton_appName_inner",id:"icon_app_"+this.app.appid+"_"+this.app.asc+"_name",text:this.app.name});var l=$("<div class='appButton_appName_inner_right'></div>");g.append(h).append(l);var i=$("<div>",{"class":"appButton_notify",id:"icon_app_"+this.app.appid+"_"+this.app.asc+"_notify",});$("<span class='appButton_notify_inner'></span>").appendTo(i);var j=$("<div>",{title:"卸载应用",id:"icon_app_"+this.app.appid+"_"+this.app.asc+"_delete","class":"appButton_delete"});this.box.append(k).append(g).append(i).append(j)},bindEvent:function(){this.box.click(function(l){l.preventDefault();l.stopPropagation();var i=$(this);var j=i.attr("appid");var k=$.trim(i.text());var h=i.attr("url");var e=i.find("img").attr("src").split("/")[3];Windows.openApp(j,k,h,e,1000,500);appManagerPanel.hide();Desktop.show()})}});appIcon_t1=appIcon_t0.extend({init:function(b){this.fid=b;this.app=datajson.app[b];this.tx=1;this.create(b);this.bindEvent()},create:function(j){this._super(1);this.box.attr({id:"icon_app_"+this.app.appid+"_"+this.app.asc,appid:this.app.appid,fileid:this.app.appid,title:this.app.name,uid:"app_"+this.app.appid,fid:j,url:this.app.url});var m=$("<div>",{id:"icon_app_"+this.app.appid+"_"+this.app.asc+"_icon_div","class":"appButton_appIcon"});m.append($("<img>",{alt:this.app.name,src:this.app.icon,"class":"appButton_appIconImg",id:"icon_app_"+this.app.appid+"_"+this.app.asc+"_img"}));var h=$("<div class='appButton_appName'></div>");var i=$("<div>",{"class":"appButton_appName_inner",id:"icon_app_"+this.app.appid+"_"+this.app.asc+"_name",text:this.app.name});var n=$("<div class='appButton_appName_inner_right'></div>");h.append(i).append(n);var k=$("<div>",{"class":"appButton_notify",id:"icon_app_"+this.app.appid+"_"+this.app.asc+"_notify"});$("<span class='appButton_notify_inner'></span>").appendTo(k);var l=$("<div>",{title:"卸载应用",id:"icon_app_"+this.app.appid+"_"+this.app.asc+"_delete","class":"appButton_delete"});this.box.append(m).append(h).append(k).append(l)},bindEvent:function(){this.box.click(function(l){l.preventDefault();l.stopPropagation();var i=$(this);var j=i.attr("appid");var k=$.trim(i.text());var h=i.attr("url");var e=i.find("img").attr("src").split("/")[3];Windows.openApp(j,k,h,e,1400,600)})}});appIcon_t2=appIcon_t0.extend({init:function(b){this.fid=b;this.sApp=DATA.sApp[b];this.tx=2;this.create();this.bindEvent()},create:function(){this._super(2);this.box.attr({id:"icon_app_"+this.sApp.appid+"_"+this.sApp.asc,appid:this.sApp.appid,fileid:this.sApp.appid,title:this.sApp.name,uid:"app_"+this.sApp.appid,url:this.sApp.url});var i=$("<div>",{id:"icon_app_"+this.sApp.appid+"_"+this.sApp.asc+"_icon_div","class":"appButton_appIcon"});i.append($("<img>",{alt:this.sApp.name,src:this.sApp.icon,"class":"appButton_appIconImg",id:"icon_app_"+this.sApp.appid+"_"+this.sApp.asc+"_img"}));var f=$("<div class='appButton_appName'></div>");var g=$("<div>",{"class":"appButton_appName_inner",id:"icon_app_"+this.sApp.appid+"_"+this.sApp.asc+"_name",text:this.sApp.name});var j=$("<div class='appButton_appName_inner_right'></div>");f.append(g).append(j);var h=$("<div",{title:"卸载应用",id:"icon_app_"+this.sApp.appid+"_"+this.sApp.asc+"_delete","class":"appButton_delete"});this.box.append(i).append(f).append(h)},bindEvent:function(){this.box.click(function(l){l.preventDefault();l.stopPropagation();var i=$(this);var j=i.attr("appid");var k=$.trim(i.text());var h=i.attr("url");var e=i.find("img").attr("src").split("/")[3];Windows.openApp(j,k,h,e,1000,500)})}});$(function(){Body.init();Desktop.init();Deskpanel.init(iconjson,true);Sidebar.init({location:"left",Icon:defaultIconForSlider});Navbar.init();BottomBar.init();appManagerPanel.init()});$(function(){$(".fsb_resultList").live("click",function(){var a=$(this).attr("idx");var d=$(this).find(".sb_resultBox_key").html();if(a=="-1"){Windows.openApp("","百度搜索","http://www.baidu.com/s?tn=13081079_1_pg&ie=utf-8&bs=fda&f=8&rsv_bp=1&rsv_spt=1&wd="+d,"default.png",1000,500)}else{if(a=="-2"){Windows.openApp("","应用搜索","functionController.do?searchApp&name="+d,"default.png",800,400)}}$(".fsb_resultList").hide()});var b=$.cookie("myskin");if(b){$("#zoomWallpaper").attr("src",b);$.cookie("myskin",b,cookieParam)}});