(function(a){var b=a(document).data("func",{});a.smartMenu=a.noop;a.fn.smartMenu=function(g,i){var f=a("body"),h={name:"",offsetX:2,offsetY:2,textLimit:6,beforeShow:a.noop,afterShow:a.noop};var d=a.extend(h,i||{});var e=function(l){var o=l||g,k=l?Math.random().toString():d.name,j="",n="",m="smart_menu_";if(a.isArray(o)&&o.length){j='<div id="smartMenu_'+k+'" class="'+m+'box"><div class="'+m+'body"><ul class="'+m+'ul">';a.each(o,function(q,p){if(q){j=j+'<li class="'+m+'li_separate">&nbsp;</li>'}if(a.isArray(p)){a.each(p,function(v,u){var x=u.text,r="",t="",w=Math.random().toString().replace(".","");if(x){if(x.length>d.textLimit){x=x.slice(0,d.textLimit)+"â€¦";t=' title="'+u.text+'"'}if(a.isArray(u.data)&&u.data.length){r='<li class="'+m+'li" data-hover="true">'+e(u.data)+'<a href="javascript:" class="'+m+'a"'+t+' data-key="'+w+'"><i class="'+m+'triangle"></i>'+x+"</a></li>"}else{r='<li class="'+m+'li"><a href="javascript:" class="'+m+'a"'+t+' data-key="'+w+'">'+x+"</a></li>"}j+=r;var s=b.data("func");s[w]=u.func;b.data("func",s)}})}});j=j+"</ul></div></div>"}return j},c=function(){var j="#smartMenu_",l="smart_menu_",k=a(j+d.name);if(!k.size()){a("body").append(e());a(j+d.name+" a").bind("click",function(){var n=a(this).attr("data-key"),m=b.data("func")[n];if(a.isFunction(m)){m.call(b.data("trigger"))}a.smartMenu.hide();return false});a(j+d.name+" li").each(function(){var n=a(this).attr("data-hover"),m=l+"li_hover";a(this).hover(function(){var o=a(this).siblings("."+m);o.removeClass(m).children("."+l+"box").hide();o.children("."+l+"a").removeClass(l+"a_hover");if(n){a(this).addClass(m).children("."+l+"box").show();a(this).children("."+l+"a").addClass(l+"a_hover")}})});return a(j+d.name)}return k};a(this).each(function(){this.oncontextmenu=function(l){if(a.isFunction(d.beforeShow)){d.beforeShow.call(this)}l=l||window.event;l.cancelBubble=true;if(l.stopPropagation){l.stopPropagation()}a.smartMenu.hide();var k=b.scrollTop();var j=c();if(j){j.css({display:"block",left:l.clientX+d.offsetX,top:l.clientY+k+d.offsetY});b.data("target",j);b.data("trigger",this);if(a.isFunction(d.afterShow)){d.afterShow.call(this)}return false}}});if(!f.data("bind")){f.bind("click",a.smartMenu.hide).data("bind",true)}};a.extend(a.smartMenu,{hide:function(){var c=b.data("target");if(c&&c.css("display")==="block"){c.hide()}},remove:function(){var c=b.data("target");if(c){c.remove()}}})})(jQuery);